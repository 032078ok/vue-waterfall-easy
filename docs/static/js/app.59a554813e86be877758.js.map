{"version":3,"sources":["webpack:///static/js/app.59a554813e86be877758.js","webpack:///./src/App.vue","webpack:///App.vue","webpack:///vue-waterfall-easy.vue","webpack:///./src/components/vue-waterfall-easy.vue","webpack:///./src/App.vue?c376","webpack:///./src/components/vue-waterfall-easy.vue?617c","webpack:///./src/main.js"],"names":["webpackJsonp","module","exports","__webpack_require__","Component","__webpack_exports__","Object","defineProperty","value","__WEBPACK_IMPORTED_MODULE_0_components_vue_waterfall_easy_vue__","__WEBPACK_IMPORTED_MODULE_0_components_vue_waterfall_easy_vue___default","n","name","data","imgsArr","fetchImgsArr","components","vueWaterfallEasy","a","methods","initImgsArr","m","arr","i","push","src","info","fetchImgsData","this","concat","created","props","gap","type","Number","default","Array","required","imgWidth","timeOut","msg","colsHeightArr","imgBoxEls","columnCount","NaN","isMobile","beginIndex","isPreloading","isPreloadingC","imgsArrC","loadedCount","isFirstTIme","computed","boxWidth","imgWidthC","window","innerWidth","waterfall","length","minHeight","Math","min","apply","minIndex","indexOf","width","offsetWidth","style","position","left","top","$set","offsetHeight","loadFn","e","oImg","_this","round","height","$nextTick","initImgBoxEls","$emit","preload","_this2","forEach","v","Image","addEventListener","initColsHeightArr","document","getElementsByClassName","initIsMobile","navigator","userAgent","match","initColumnCount","winWidth","mounted","_this3","$on","body","scrollTop","innerHeight","scrollHeight","watch","newV","oldV","_this4","setTimeout","render","_vm","_h","$createElement","_c","_self","attrs","id","staticClass","_v","on","scrollLoadImg","scopedSlots","_u","key","fn","_s","index","staticRenderFns","marginLeft","_l","padding","_t","class","first-loading","_e","__WEBPACK_IMPORTED_MODULE_0_vue__","__WEBPACK_IMPORTED_MODULE_0_vue___default","__WEBPACK_IMPORTED_MODULE_1__App__","__WEBPACK_IMPORTED_MODULE_1__App___default","el","template","App"],"mappings":"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","file":"static/js/app.59a554813e86be877758.js","sourcesContent":["webpackJsonp([0,2],[\n/* 0 */,\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(5)\n\nvar Component = __webpack_require__(0)(\n  /* script */\n  __webpack_require__(3),\n  /* template */\n  __webpack_require__(8),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 2 */,\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_components_vue_waterfall_easy_vue__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_components_vue_waterfall_easy_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_components_vue_waterfall_easy_vue__);\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = {\n  name: 'app',\n  data: function data() {\n    return {\n      imgsArr: [],\n      fetchImgsArr: []\n    };\n  },\n\n  components: {\n    vueWaterfallEasy: __WEBPACK_IMPORTED_MODULE_0_components_vue_waterfall_easy_vue___default.a\n  },\n  methods: {\n    initImgsArr: function initImgsArr(n, m) {\n      var arr = [];\n      for (var i = n; i < m; i++) {\n        arr.push({ src: 'static/img/' + (i + 1) + '.jpg', info: '一些图片描述文字' });\n      }\n      return arr;\n    },\n    fetchImgsData: function fetchImgsData() {\n      this.imgsArr = this.imgsArr.concat(this.fetchImgsArr);\n    }\n  },\n  created: function created() {\n    this.imgsArr = this.initImgsArr(0, 10);\n    this.fetchImgsArr = this.initImgsArr(10, 20);\n  }\n};\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = {\n  name: 'vue-waterfall-easy',\n  props: {\n    gap: {\n      type: Number,\n      default: 20\n    },\n    imgsArr: {\n      type: Array,\n      required: true\n    },\n    imgWidth: {\n      type: Number,\n      default: 240\n    },\n    timeOut: {\n      type: Number,\n      default: 500\n    }\n  },\n  data: function data() {\n    return {\n      msg: 'this is from vue-waterfall-easy.vue',\n      colsHeightArr: [],\n      imgBoxEls: null,\n      columnCount: NaN,\n      isMobile: false,\n      beginIndex: NaN,\n      isPreloading: true,\n      isPreloadingC: true,\n      imgsArrC: [],\n      loadedCount: 0,\n      isFirstTIme: true };\n  },\n\n  computed: {\n    boxWidth: function boxWidth() {\n      return this.imgWidth + this.gap;\n    },\n    imgWidthC: function imgWidthC() {\n      return this.isMobile ? window.innerWidth / 2 - this.gap : this.imgWidth;\n    }\n  },\n  methods: {\n    waterfall: function waterfall() {\n      for (var i = this.beginIndex; i < this.imgsArr.length; i++) {\n        var minHeight = Math.min.apply(null, this.colsHeightArr);\n        var minIndex = this.colsHeightArr.indexOf(minHeight);\n        var width = this.imgBoxEls[0].offsetWidth;\n        this.imgBoxEls[i].style.position = 'absolute';\n        this.imgBoxEls[i].style.left = minIndex * width + 'px';\n        this.imgBoxEls[i].style.top = minHeight + 'px';\n\n        this.$set(this.colsHeightArr, minIndex, minHeight + this.imgBoxEls[i].offsetHeight);\n      }\n      this.beginIndex = this.imgsArr.length;\n    },\n    loadFn: function loadFn(e, oImg, i) {\n      var _this = this;\n\n      this.loadedCount++;\n      if (e.type === 'load') {\n        this.$set(this.imgsArr[i], 'height', Math.round(this.imgWidthC / (oImg.width / oImg.height)));\n      }\n      if (this.loadedCount === this.imgsArr.length) {\n        this.imgsArrC = this.imgsArr.concat([]);\n\n        this.isPreloading = false;\n        this.isFirstTIme = false;\n\n        this.$nextTick(function () {\n          _this.initImgBoxEls();\n          _this.$emit('preloaded');\n        });\n      }\n    },\n    preload: function preload() {\n      var _this2 = this;\n\n      this.imgsArr.forEach(function (v, i) {\n        if (i < _this2.loadedCount) return;\n        var oImg = new Image();\n        oImg.addEventListener('load', function (e) {\n          _this2.loadFn(e, oImg, i);\n        });\n        oImg.src = v.src;\n      });\n    },\n    initColsHeightArr: function initColsHeightArr() {\n      this.colsHeightArr = [];\n      for (var i = 0; i < this.columnCount; i++) {\n        this.imgBoxEls[i].style.position = 'static';\n        var height = this.imgBoxEls[i].offsetHeight;\n        this.colsHeightArr.push(height);\n      }\n    },\n    initImgBoxEls: function initImgBoxEls() {\n      this.imgBoxEls = document.getElementsByClassName('img-box');\n    },\n    initIsMobile: function initIsMobile() {\n      if (navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)) this.isMobile = true;\n    },\n    initColumnCount: function initColumnCount() {\n      var winWidth = window.innerWidth;\n      if (winWidth > this.boxWidth * 5) {\n        this.columnCount = 5;\n      } else if (winWidth > this.boxWidth * 4) {\n        this.columnCount = 4;\n      } else if (winWidth > this.boxWidth * 3) {\n        this.columnCount = 3;\n      } else if (winWidth > this.boxWidth * 2) {\n        this.columnCount = 2;\n      } else {\n        this.columnCount = this.isMobile ? 2 : 1;\n      }\n      this.beginIndex = this.columnCount;\n    }\n  },\n  mounted: function mounted() {\n    var _this3 = this;\n\n    this.initIsMobile();\n    this.initColumnCount();\n\n    this.preload();\n\n    this.$on('preloaded', function () {\n      if (_this3.colsHeightArr.length === 0) _this3.initColsHeightArr();\n      _this3.waterfall();\n    });\n\n    window.addEventListener('resize', function () {\n      _this3.initColumnCount();\n      _this3.initColsHeightArr();\n      _this3.waterfall();\n    });\n\n    window.addEventListener('scroll', function () {\n      if (_this3.isPreloading) return;\n      if (document.body.scrollTop + window.innerHeight > document.body.scrollHeight - 30) {\n        _this3.$emit('scrollLoadImg');\n      }\n    });\n  },\n\n  watch: {\n    imgsArr: function imgsArr(newV, oldV) {\n      if (newV.length === oldV.length) return;\n      this.isPreloading = true;\n      this.preload();\n    },\n    isPreloading: function isPreloading(v) {\n      var _this4 = this;\n\n      if (v) {\n        setTimeout(function () {\n          if (!_this4.isPreloading) return;\n          _this4.isPreloadingC = true;\n        }, 500);\n      } else {\n        this.isPreloadingC = false;\n      }\n    }\n  }\n};\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\n/* styles */\n__webpack_require__(6)\n\nvar Component = __webpack_require__(0)(\n  /* script */\n  __webpack_require__(4),\n  /* template */\n  __webpack_require__(9),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"app\"\n    }\n  }, [_c('h1', {\n    staticClass: \"title\"\n  }, [_vm._v(\"vue-waterfall-easy demo\")]), _c('vue-waterfall-easy', {\n    attrs: {\n      \"imgsArr\": _vm.imgsArr\n    },\n    on: {\n      \"scrollLoadImg\": _vm.fetchImgsData\n    },\n    scopedSlots: _vm._u([{\n      key: \"default\",\n      fn: function(props) {\n        return [_c('p', {\n          staticClass: \"some-info\"\n        }, [_vm._v(\"第\" + _vm._s(props.index + 1) + \"张图片\")]), _c('p', {\n          staticClass: \"some-info\"\n        }, [_vm._v(_vm._s(props.value.info))])]\n      }\n    }])\n  })], 1)\n},staticRenderFns: []}\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"vue-waterfall-easy\",\n    style: (_vm.isMobile ? '' : {\n      width: _vm.boxWidth * _vm.columnCount + 'px',\n      left: '50%',\n      marginLeft: -1 * _vm.boxWidth * _vm.columnCount / 2 + 'px'\n    })\n  }, [_vm._l((_vm.imgsArrC), function(v, i) {\n    return _c('div', {\n      staticClass: \"img-box\",\n      style: ({\n        padding: _vm.gap / 2 + 'px',\n        width: _vm.isMobile ? '' : _vm.boxWidth + 'px'\n      })\n    }, [_c('div', {\n      staticClass: \"img-inner-box\"\n    }, [_c('div', {\n      staticClass: \"img-wraper\",\n      style: ({\n        width: _vm.imgWidthC + 'px',\n        height: v.height ? v.height + 'px' : ''\n      })\n    }, [_c('img', {\n      attrs: {\n        \"src\": v.src\n      }\n    })]), _c('div', {\n      staticClass: \"img-info\"\n    }, [_vm._t(\"default\", null, {\n      index: i,\n      value: v\n    })], 2)])])\n  }), (_vm.isPreloadingC) ? _c('div', {\n    staticClass: \"loading\",\n    class: {\n      'first-loading': _vm.isFirstTIme\n    }\n  }, [_c('div', {\n    staticClass: \"double-bounce1\"\n  }), _c('div', {\n    staticClass: \"double-bounce2\"\n  })]) : _vm._e()], 2)\n},staticRenderFns: []}\n\n/***/ }),\n/* 10 */,\n/* 11 */,\n/* 12 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_vue__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__App__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__App___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__App__);\n\n\n\n\nnew __WEBPACK_IMPORTED_MODULE_0_vue___default.a({\n  el: '#app',\n  template: '<App/>',\n  components: { App: __WEBPACK_IMPORTED_MODULE_1__App___default.a }\n});\n\n/***/ })\n],[12]);\n\n\n// WEBPACK FOOTER //\n// static/js/app.59a554813e86be877758.js","\n/* styles */\nrequire(\"!!./../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?minimize&sourceMap!./../node_modules/vue-loader/lib/style-rewriter?{\\\"id\\\":\\\"data-v-000761d9\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":true}!sass-loader?sourceMap!./../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n\nvar Component = require(\"!./../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!./../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"),\n  /* template */\n  require(\"!!./../node_modules/vue-loader/lib/template-compiler?{\\\"id\\\":\\\"data-v-000761d9\\\"}!./../node_modules/vue-loader/lib/template-loader?raw&engine=pug!./../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = 1\n// module chunks = 0","<template lang=\"pug\">\n #app\n  h1.title vue-waterfall-easy demo\n  vue-waterfall-easy(:imgsArr=\"imgsArr\",@scrollLoadImg=\"fetchImgsData\")\n    template( scope=\"props\")\n      p.some-info 第{{props.index+1}}张图片\n      p.some-info {{props.value.info}}\n  </template>\n</template>\n\n<script>\nimport vueWaterfallEasy from 'components/vue-waterfall-easy.vue'\n\nexport default {\n  name: 'app',\n  data() {\n    return {\n      imgsArr: [],\n      fetchImgsArr: []\n    }\n  },\n  components: {\n    vueWaterfallEasy\n  },\n  methods: {\n    // 假数据\n    initImgsArr(n, m) { //num 图片数量\n      var arr = []\n      for (var i = n; i < m; i++) {\n        arr.push({ src: `static/img/${i + 1}.jpg`, info: '一些图片描述文字' })\n      }\n      return arr\n    },\n\n    fetchImgsData() {\n      this.imgsArr = this.imgsArr.concat(this.fetchImgsArr)\n    }\n  },\n  created() {\n    this.imgsArr = this.initImgsArr(0, 10)\n    this.fetchImgsArr = this.initImgsArr(10, 20) // 模拟每次请求的新的图片的数据数据\n  },\n\n}\n\n</script>\n\n<style lang=\"scss\">\n* {\n  margin: 0;\n  padding: 0;\n}\n\n#app {\n  font-family: microsoft yahei;\n\n  .some-info {\n    line-height: 1.6;\n    text-align: center;\n  }\n  .title {\n    background: #000;\n    color: #ccc;\n    text-align: center;\n    font-size: 24px;\n    line-height: 40px;\n    width: 100%;\n    position: fixed;\n    top: 0;\n    z-index: 999;\n  }\n  .vue-waterfall-easy {\n    top: 40px;\n  }\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// App.vue?b8cb7d8e","<!-- —————————————↓SCSS———————分界线————————————————————————— -->\n<style lang=\"scss\">\n.vue-waterfall-easy {\n  position: absolute;\n  width: 100%; // 移动端生效\n  .img-box {\n    width: 50%; // 移动端生效\n\n    box-sizing: border-box;\n    float: left; // 首行排版\n    transition: left 1s, top 1s;\n\n    .img-inner-box {\n      box-shadow: 0 1px 3px rgba(0, 0, 0, .3);\n      .img-wraper {\n        width: 100%;\n        background: yellow;\n      }\n      img {\n        width: 100%;\n        vertical-align: bottom;\n      }\n      .img-info {\n        background: #fff;\n        padding: .6em;\n      }\n    }\n  }\n  .loading {\n    text-align: center;\n    width: 100%;\n    position: fixed;\n    bottom: 10px;\n    left: 50%;\n    margin-left: -15px;\n    width: 30px;\n    height: 30px;\n  }\n  .loading.first-loading {\n    //  首次预加载白屏，让加载动画处于中间\n    top: 50%;\n    margin-top: -15px;\n  }\n  .double-bounce1,\n  .double-bounce2 {\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: #67CF22;\n    opacity: 0.6;\n    position: absolute;\n    top: 0;\n    left: 0;\n\n    animation: bounce 2.0s infinite ease-in-out;\n  }\n\n  .double-bounce2 {\n    animation-delay: -1.0s;\n  }\n\n\n\n  @keyframes bounce {\n    0%,\n    100% {\n      transform: scale(0.0);\n    }\n    50% {\n      transform: scale(1.0);\n    }\n  }\n}\n</style>\n\n<!-- —————————————↓HTML————————分界线———————————————————————— -->\n<template lang=\"pug\">\n.vue-waterfall-easy(\n  :style=\"isMobile? '':{width:boxWidth*columnCount+'px',left:'50%',marginLeft: -1*boxWidth*columnCount/2 +'px'}\"\n)\n  .img-box(\n    v-for=\"(v,i) in imgsArrC\",\n    :style=\"{padding:gap/2+'px',width: isMobile ? '' : boxWidth+'px'}\"\n  )\n    .img-inner-box\n      div.img-wraper(:style=\"{width:imgWidthC+'px',height:v.height?v.height+'px':''}\")\n        img(:src=\"v.src\")\n      .img-info\n        slot(:index=\"i\",:value=\"v\")\n\n  .loading(v-if=\"isPreloadingC\",:class=\"{'first-loading':isFirstTIme}\")\n    div.double-bounce1\n    div.double-bounce2\n\n\n</template>\n\n<!-- ——————————————↓JS—————————分界线———————————————————————— -->\n<script>\n//import XXX from './components/XXX'\n\nexport default {\n  name: 'vue-waterfall-easy',\n  props: {\n    gap: {\n      type: Number,\n      default: 20\n    },\n    imgsArr: {\n      type: Array,\n      required: true\n    },\n    imgWidth: {\n      type: Number,\n      default: 240\n    },\n    timeOut: { // 预加载事件小于500毫秒就不显示加载动画，增加用户体验\n      type: Number,\n      default: 500\n    }\n  },\n  data() {\n    return {\n      msg: 'this is from vue-waterfall-easy.vue',\n      colsHeightArr: [],\n      imgBoxEls: null, // 所有的.img-box元素\n      columnCount: NaN, // 列数，根据窗口大小初始化\n      isMobile: false, // 移动端判断\n      beginIndex: NaN,\n      isPreloading: true, // 预加载状态中（1.以等待图片替换 2.图片全部预加载完显示）\n      isPreloadingC: true,\n      imgsArrC: [], // 预加载完之后再\n      loadedCount: 0, // 已经加载图片数量\n      isFirstTIme: true, // 首次加载\n    }\n  },\n  computed: {\n    boxWidth() {\n      return this.imgWidth + this.gap\n    },\n    imgWidthC() {\n      return this.isMobile ? window.innerWidth / 2 - this.gap : this.imgWidth\n    }\n  },\n  methods: {\n    waterfall() { // 执行瀑布布局\n      for (var i = this.beginIndex; i < this.imgsArr.length; i++) {\n        var minHeight = Math.min.apply(null, this.colsHeightArr) // 最低高低\n        // alert(this.colsHeightArr)\n        var minIndex = this.colsHeightArr.indexOf(minHeight) // 最低高度的索引\n        // console.log(this.colsHeightArr, minHeight, minIndex)\n        var width = this.imgBoxEls[0].offsetWidth // 图片的宽度获取\n        // 设置元素定位的位置\n        // console.log(this.imgBoxEls[i],i)\n        this.imgBoxEls[i].style.position = 'absolute'\n        this.imgBoxEls[i].style.left = minIndex * width + 'px'\n        this.imgBoxEls[i].style.top = minHeight + 'px'\n\n        // 更新colsHeightArr\n        // console.log(this.imgsArr, this.imgsArr[i].height, i)\n        // var height = Math.round(this.imgBoxEls[i].getElementsByClassName('img-info')[0].offsetHeight + this.imgsArr[i].height + this.gap)\n        this.$set(this.colsHeightArr, minIndex, minHeight + this.imgBoxEls[i].offsetHeight)\n      }\n      this.beginIndex = this.imgsArr.length\n      // console.log(this.colsHeightArr)\n    },\n\n    loadFn(e, oImg, i) {\n      this.loadedCount++\n      if (e.type === 'load') { // 使用图片原始宽度计算图片的高度\n        // var imgWidth = this.isMobile ? window.innerWidth / 2-this.gap : this.imgWidth\n        this.$set(this.imgsArr[i], 'height', Math.round(this.imgWidthC / (oImg.width / oImg.height)))\n      }\n      if (this.loadedCount === this.imgsArr.length) {\n        this.imgsArrC = this.imgsArr.concat([])\n\n\n        this.isPreloading = false\n        this.isFirstTIme = false\n\n        // 预加载完毕\n        this.$nextTick(() => {\n          this.initImgBoxEls()\n          this.$emit('preloaded')\n\n        })\n      }\n    },\n    preload() {\n      this.imgsArr.forEach((v, i) => {\n        if (i < this.loadedCount) return\n        var oImg = new Image()\n        oImg.addEventListener('load', (e) => {\n          this.loadFn(e, oImg, i)\n        })\n        oImg.src = v.src\n      })\n    },\n\n\n    // -----------------初始化化------------------------\n\n    initColsHeightArr() { // 第一行元素的高度组成的数组-初始化\n      this.colsHeightArr = [] // 列数发生变化\n      for (var i = 0; i < this.columnCount; i++) {\n        this.imgBoxEls[i].style.position = 'static' // 重置下position\n        var height = this.imgBoxEls[i].offsetHeight\n        this.colsHeightArr.push(height)\n      }\n    },\n    initImgBoxEls() { // 初始化所有装图片的元素集合,注意高度获取需要在图片加载完成之后，所以在window.onload 事件中初始化\n      this.imgBoxEls = document.getElementsByClassName('img-box')\n    },\n    initIsMobile() { // 移动端初始化\n      if (navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)) this.isMobile = true\n    },\n    initColumnCount() { // 列数初始化\n      var winWidth = window.innerWidth\n      if (winWidth > this.boxWidth * 5) {\n        this.columnCount = 5\n      } else if (winWidth > this.boxWidth * 4) {\n        this.columnCount = 4\n      } else if (winWidth > this.boxWidth * 3) {\n        this.columnCount = 3\n      } else if (winWidth > this.boxWidth * 2) {\n        this.columnCount = 2\n      } else {\n        this.columnCount = this.isMobile ? 2 : 1\n      }\n      this.beginIndex = this.columnCount // 开始排列的元素索引\n\n    },\n  },\n  mounted() {\n    // 初始化\n    this.initIsMobile()\n    this.initColumnCount()\n\n    this.preload()\n\n    this.$on('preloaded', () => {\n      if (this.colsHeightArr.length === 0) this.initColsHeightArr() // 第一次初始化\n      this.waterfall()\n    })\n\n    window.addEventListener('resize', () => {\n      this.initColumnCount()\n      this.initColsHeightArr()\n      this.waterfall()\n    })\n\n    window.addEventListener('scroll', () => {\n      if (this.isPreloading) return\n      if (document.body.scrollTop + window.innerHeight > document.body.scrollHeight - 30) {\n        this.$emit('scrollLoadImg')\n\n      }\n    })\n\n  },\n  watch: {\n    imgsArr(newV, oldV) {\n      if (newV.length === oldV.length) return\n      this.isPreloading = true // 预加载新的图片资源\n      this.preload()\n\n      // setTimeout(()=>{ // 模拟图片预加载时间为1s\n\n      // this.preload()\n      // },1000)\n\n    },\n    isPreloading(v) {\n      if (v) {\n        setTimeout(() => {\n          if (!this.isPreloading) return // 500毫秒内预加载完图片则不显示加载动画\n          this.isPreloadingC = true\n        }, 500)\n      } else {\n        this.isPreloadingC = false\n      }\n\n    }\n  }\n}\n</script>\n\n\n\n// WEBPACK FOOTER //\n// vue-waterfall-easy.vue?325de5c7","\n/* styles */\nrequire(\"!!./../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?minimize&sourceMap!./../../node_modules/vue-loader/lib/style-rewriter?{\\\"id\\\":\\\"data-v-4669e716\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":true}!sass-loader?sourceMap!./../../node_modules/vue-loader/lib/selector?type=styles&index=0!./vue-waterfall-easy.vue\")\n\nvar Component = require(\"!./../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!./../../node_modules/vue-loader/lib/selector?type=script&index=0!./vue-waterfall-easy.vue\"),\n  /* template */\n  require(\"!!./../../node_modules/vue-loader/lib/template-compiler?{\\\"id\\\":\\\"data-v-4669e716\\\"}!./../../node_modules/vue-loader/lib/template-loader?raw&engine=pug!./../../node_modules/vue-loader/lib/selector?type=template&index=0!./vue-waterfall-easy.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/vue-waterfall-easy.vue\n// module id = 7\n// module chunks = 0","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"app\"\n    }\n  }, [_c('h1', {\n    staticClass: \"title\"\n  }, [_vm._v(\"vue-waterfall-easy demo\")]), _c('vue-waterfall-easy', {\n    attrs: {\n      \"imgsArr\": _vm.imgsArr\n    },\n    on: {\n      \"scrollLoadImg\": _vm.fetchImgsData\n    },\n    scopedSlots: _vm._u([{\n      key: \"default\",\n      fn: function(props) {\n        return [_c('p', {\n          staticClass: \"some-info\"\n        }, [_vm._v(\"第\" + _vm._s(props.index + 1) + \"张图片\")]), _c('p', {\n          staticClass: \"some-info\"\n        }, [_vm._v(_vm._s(props.value.info))])]\n      }\n    }])\n  })], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?{\"id\":\"data-v-000761d9\"}!./~/vue-loader/lib/template-loader.js?raw&engine=pug!./~/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = 8\n// module chunks = 0","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"vue-waterfall-easy\",\n    style: (_vm.isMobile ? '' : {\n      width: _vm.boxWidth * _vm.columnCount + 'px',\n      left: '50%',\n      marginLeft: -1 * _vm.boxWidth * _vm.columnCount / 2 + 'px'\n    })\n  }, [_vm._l((_vm.imgsArrC), function(v, i) {\n    return _c('div', {\n      staticClass: \"img-box\",\n      style: ({\n        padding: _vm.gap / 2 + 'px',\n        width: _vm.isMobile ? '' : _vm.boxWidth + 'px'\n      })\n    }, [_c('div', {\n      staticClass: \"img-inner-box\"\n    }, [_c('div', {\n      staticClass: \"img-wraper\",\n      style: ({\n        width: _vm.imgWidthC + 'px',\n        height: v.height ? v.height + 'px' : ''\n      })\n    }, [_c('img', {\n      attrs: {\n        \"src\": v.src\n      }\n    })]), _c('div', {\n      staticClass: \"img-info\"\n    }, [_vm._t(\"default\", null, {\n      index: i,\n      value: v\n    })], 2)])])\n  }), (_vm.isPreloadingC) ? _c('div', {\n    staticClass: \"loading\",\n    class: {\n      'first-loading': _vm.isFirstTIme\n    }\n  }, [_c('div', {\n    staticClass: \"double-bounce1\"\n  }), _c('div', {\n    staticClass: \"double-bounce2\"\n  })]) : _vm._e()], 2)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?{\"id\":\"data-v-4669e716\"}!./~/vue-loader/lib/template-loader.js?raw&engine=pug!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/vue-waterfall-easy.vue\n// module id = 9\n// module chunks = 0","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  template: '<App/>',\n  components: { App }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}